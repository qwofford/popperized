BootStrap: library
From: centos:latest

%post
    mkdir -p /opt/bsp_simulator
    rpm --import https://www.centos.org/keys/RPM-GPG-KEY-CentOS-7
    yum -y install centos-release-scl 
    yum -y install wget openmpi-devel gsl-devel libgfortran gmp-devel rh-python36 rh-python36-numpy zsh openssl-devel perf
    yum -y group install "Development Tools"
    ln -s /usr/lib64/openmpi/bin/mpic++ /usr/bin/mpic++
    ln -s /usr/lib64/openmpi/bin/mpirun /usr/bin/mpirun
    wget -P /opt/bsp_simulator/ https://lobogit.unm.edu/wasp/bsp_prototype/-/archive/47e45d8d3aa8ed915e63d8b03bedadd7a3420c68/bsp_prototype-47e45d8d3aa8ed915e63d8b03bedadd7a3420c68.tar.gz
    tar -xf /opt/bsp_simulator/bsp_prototype-47e45d8d3aa8ed915e63d8b03bedadd7a3420c68.tar.gz -C /opt/bsp_simulator/
    pushd /opt/bsp_simulator/bsp_prototype-47e45d8d3aa8ed915e63d8b03bedadd7a3420c68/sprng5
    /usr/bin/zsh ./installSprng
    popd
    pushd /opt/bsp_simulator/bsp_prototype-47e45d8d3aa8ed915e63d8b03bedadd7a3420c68/
    make
    popd
%runscript
    /opt/rh/rh-python36/root/bin/python3.6 /opt/bsp_simulator/bsp_prototype-47e45d8d3aa8ed915e63d8b03bedadd7a3420c68/data_gen.py
    /opt/bsp_simulator/bsp_prototype-47e45d8d3aa8ed915e63d8b03bedadd7a3420c68/gather_new.sh
%labels
    Author QuincyWofford,KeiraHaskins
